steps:
  - name: 'gcr.io/google.com/cloudsdktool/cloud-sdk'
    entrypoint: 'sh'
    args:
    - '-c'
    - |
        PROJECT_ID=$(gcloud config list --format 'value(core.project)' 2>/dev/null)
        gcloud builds submit --tag gcr.io/"${PROJECT_ID}"/mintposterbot

  - name: 'gcr.io/google.com/cloudsdktool/cloud-sdk'
    entrypoint: 'sh'
    args:
      - '-c'
      - |
        gcloud compute instances create-with-container haspass-expo --container-image gcr.io/spartan-theorem-328817/mintposterbot:latest --service-account mint-poster-bot@spartan-theorem-328817.iam.gserviceaccount.com --scopes "https://www.googleapis.com/auth/cloud-platform" --zone europe-west1-b
